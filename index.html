<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F0</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-color: #f4f4f4;
        }
        .game-container {
            display: grid;
            grid-template-columns: repeat(5, 80px);
            gap: 20px;
        }
        .tube {
            width: 80px;
            height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            align-items: center;
            border: 4px solid #333;
            background-color: white;
            border-radius: 40px 40px 10px 10px;
            padding: 5px;
            position: relative;
            overflow: hidden;
        }
        .color-segment {
            width: 90%;
            height: 25%;
            border-radius: 5px;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <h1>Lixei-me com F0</h1>
    <div class="game-container" id="game">
        <div class="tube" onclick="selectTube(0)"></div>
        <div class="tube" onclick="selectTube(1)"></div>
        <div class="tube" onclick="selectTube(2)"></div>
        <div class="tube" onclick="selectTube(3)"></div>
        <div class="tube" onclick="selectTube(4)"></div>
        <div class="tube" onclick="selectTube(5)"></div>
        <div class="tube" onclick="selectTube(6)"></div>
        <div class="tube" onclick="selectTube(7)"></div>
        <div class="tube" onclick="selectTube(8)"></div>
        <div class="tube" onclick="selectTube(9)"></div>
    </div>
    <img id="winImage" class="hidden" src="images/VaoEncher.png" alt="You Win!" />
    <script>
        let tubes = [
            ["cyan", "magenta", "green", "blue"],
            ["purple", "yellow", "pink"],
            ["cyan", "magenta"],
            ["green", "blue", "purple", "yellow"],
            ["pink", "cyan", "magenta"],
            ["green", "cyan"],
            ["blue", "purple", "yellow", "pink"],
            ["magenta", "green"],
            ["blue", "purple", "yellow"],
            ["pink"]
        ];
        let selectedTube = null;

        function renderTubes() {
            document.querySelectorAll(".tube").forEach((tube, index) => {
                tube.innerHTML = "";
                tubes[index].slice().reverse().forEach(color => {
                    let div = document.createElement("div");
                    div.className = "color-segment";
                    div.style.backgroundColor = color;
                    tube.appendChild(div);
                });
            });
        }

        function selectTube(index) {
            if (selectedTube === null) {
                if (tubes[index].length > 0) {
                    selectedTube = index;
                }
            } else {
                if (index !== selectedTube && tubes[index].length < 4) {
                    let fromTube = tubes[selectedTube];
                    let toTube = tubes[index];
                    
                    let colorToMove = fromTube[fromTube.length - 1];
                    if (toTube.length === 0 || toTube[toTube.length - 1] === colorToMove) {
                        let moveStack = [];
                        while (fromTube.length > 0 && fromTube[fromTube.length - 1] === colorToMove && toTube.length + moveStack.length < 4) {
                            moveStack.push(fromTube.pop());
                        }
                        while (moveStack.length > 0) {
                            toTube.push(moveStack.pop());
                        }
                    }
                    selectedTube = null;
                    checkWinCondition();
                } else {
                    selectedTube = null;
                }
            }
            renderTubes();
        }

        function checkWinCondition() {
            if (tubes.every(tube => tube.length === 0 || (tube.length === 4 && tube.every(color => color === tube[0])))) {
                document.getElementById("game").classList.add("hidden");
                document.getElementById("winImage").classList.remove("hidden");
                sleep(5000);
                window.location.href = "/SaoUmaVergonha.html";
            }
        }

        function redirect(subpage) {
            window.location.href = subpage;
        }

        renderTubes();
        document.addEventListener('contextmenu', (e) => e.preventDefault());
        document.addEventListener('keydown', (e) => {
        if (e.ctrlKey && e.shiftKey && e.code === 'KeyC') {
            e.preventDefault();
        }
        });
    </script>
</body>
</html>
